function changeGiscusTheme(e){"dark"===e?e="dark":"light"===e?e="light":"sepia"===e?e="gruvbox_light":"pastel"===e?e="light":"midnight"===e?e="transparent_dark":"forest"===e?e="light":"paper"===e?e="light":"lavender"===e?e="catppuccin_latte":"dark-sepia"===e?e="gruvbox_dark":"dark-pastel"===e?e="catppuccin_frappe":"dark-forest"===e?e="transparent_dark":"dark-paper"===e?e="transparent_dark":"dark-lavender"===e&&(e="catppuccin_mocha"),!function e(t){let s=document.querySelector("iframe.giscus-frame");s&&s.contentWindow.postMessage({giscus:t},"https://giscus.app")}({setConfig:{theme:e}}),console.log("Giscus script added.")}function classChangeTheme(e,t){Array.from(document.getElementsByClassName(e)).forEach(e=>{e.classList.remove("theme1"),e.classList.remove("theme2"),e.classList.remove("theme3"),e.classList.remove("theme4"),e.classList.remove("theme5"),e.classList.remove("theme6"),e.classList.add(t)})}function loadSettingsFromLocalStorage(){try{let e=JSON.parse(localStorage.getItem("settings"));if(!e)return null;return e.theme&&(document.getElementById("set-theme").value=e.theme),e.font&&(document.getElementById("set-font").value=e.font),e.fontSize&&(document.getElementById("set-font-size").value=e.fontSize),e.fontWeight&&(document.getElementById("set-font-weight").value=e.fontWeight),e.lineHeight&&(document.getElementById("set-line-height").value=e.lineHeight),void 0!==e.richTextToggle&&(document.getElementById("set-rich-text-toggle").checked=e.richTextToggle),e.systemMsgStyle&&(document.getElementById("set-rich-system-msg").value=e.systemMsgStyle),e.systemWindowStyle&&(document.getElementById("set-rich-system-window").value=e.systemWindowStyle),e.constSpeechStyle&&(document.getElementById("set-rich-const").value=e.constSpeechStyle),e.outerSpeechStyle&&(document.getElementById("set-rich-outer").value=e.outerSpeechStyle),e.quoteStyle&&(document.getElementById("set-rich-quote").value=e.quoteStyle),e.noticeStyle&&(document.getElementById("set-rich-notice").value=e.noticeStyle),e.genericBoxStyle&&(document.getElementById("set-rich-box").value=e.genericBoxStyle),e}catch(t){return console.error("Error loading settings from local storage:",t),{}}}setInterval(()=>{changeGiscusTheme(window.theme)},2e3),setTimeout(()=>{let e=document.getElementById("main-script"),t=e.dataset.index,s=e.dataset.type;localStorage.setItem("lastread",String(t)),localStorage.setItem("lasttype",String(s))},6e4),loadSettingsFromLocalStorage(),window.theme="dark",document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("settings-form");function t(){let e=document.documentElement,t=document.getElementById("set-theme").value,s=document.getElementById("set-font").value,r=document.getElementById("set-font-size").value,o=document.getElementById("set-font-weight").value,l=document.getElementById("set-line-height").value,y=document.getElementById("set-rich-text-toggle").checked,n=document.getElementById("set-rich-system-msg").value,a=document.getElementById("set-rich-system-window").value,i=document.getElementById("set-rich-const").value,c=document.getElementById("set-rich-outer").value,d=document.getElementById("set-rich-quote").value,h=document.getElementById("set-rich-notice").value,p=document.getElementById("set-rich-box").value;r<30&&(r=30),r>100&&(r=100),r/=3,r+="px",l>100&&(l=100),l<1&&(l=1),l/=20,e.style.setProperty("--line-space",l+"rem"),window.theme=t,changeGiscusTheme(t),"dark"===t?(e.style.setProperty("--body-background","#14151b"),e.style.setProperty("--primary","#1f2129"),e.style.setProperty("--nav","#18191f"),e.style.setProperty("--text-primary","#b6bccc"),e.style.setProperty("--text-secondary","#c6cee2"),e.style.setProperty("--icons-color","")):"light"===t?(e.style.setProperty("--body-background","#ffffff"),e.style.setProperty("--primary","#f0f0f0"),e.style.setProperty("--nav","#d0d0d0"),e.style.setProperty("--text-primary","#000000"),e.style.setProperty("--text-secondary","#333333"),e.style.setProperty("--icons-color","brightness(40%)")):"sepia"===t?(e.style.setProperty("--body-background","#cab793"),e.style.setProperty("--primary","#f5deb3"),e.style.setProperty("--nav","#ac9b7c"),e.style.setProperty("--text-primary","#000000"),e.style.setProperty("--text-secondary","#000000"),e.style.setProperty("--icons-color",""),e.style.setProperty("--icons-color","brightness(40%)")):"pastel"===t?(e.style.setProperty("--body-background","#f9f5f6"),e.style.setProperty("--primary","#f0e6ef"),e.style.setProperty("--nav","#e3c2d9"),e.style.setProperty("--text-primary","#4a3b4c"),e.style.setProperty("--text-secondary","#635066"),e.style.setProperty("--icons-color","brightness(40%)")):"midnight"===t?(e.style.setProperty("--body-background","#000"),e.style.setProperty("--primary","#000"),e.style.setProperty("--nav","#0e0e18"),e.style.setProperty("--text-primary","#c0c8d0"),e.style.setProperty("--text-secondary","#a8b0b8"),e.style.setProperty("--icons-color","brightness(100)")):"forest"===t?(e.style.setProperty("--body-background","#e8f5e9"),e.style.setProperty("--primary","#c8e6c9"),e.style.setProperty("--nav","#a5d6a7"),e.style.setProperty("--text-primary","#2e7d32"),e.style.setProperty("--text-secondary","#388e3c"),e.style.setProperty("--icons-color","brightness(40%)")):"paper"===t?(e.style.setProperty("--body-background","#f8f5f0"),e.style.setProperty("--primary","#f5f0e8"),e.style.setProperty("--nav","#e8e0d8"),e.style.setProperty("--text-primary","#333333"),e.style.setProperty("--text-secondary","#444444"),e.style.setProperty("--icons-color","brightness(40%)")):"lavender"===t?(e.style.setProperty("--body-background","#f3efff"),e.style.setProperty("--primary","#ede7f6"),e.style.setProperty("--nav","#ded5e8"),e.style.setProperty("--text-primary","#4527a0"),e.style.setProperty("--text-secondary","#512da8"),e.style.setProperty("--icons-color","brightness(40%)")):"dark-sepia"===t?(e.style.setProperty("--body-background","#2a241e"),e.style.setProperty("--primary","#322c26"),e.style.setProperty("--nav","#2e2822"),e.style.setProperty("--text-primary","#d2c8bc"),e.style.setProperty("--text-secondary","#c0b6aa"),e.style.setProperty("--icons-color","brightness(100%)")):"dark-pastel"===t?(e.style.setProperty("--body-background","#1e1b1e"),e.style.setProperty("--primary","#28252a"),e.style.setProperty("--nav","#252227"),e.style.setProperty("--text-primary","#d1c2d3"),e.style.setProperty("--text-secondary","#b9a9bc"),e.style.setProperty("--icons-color","brightness(100%)")):"dark-forest"===t?(e.style.setProperty("--body-background","#121813"),e.style.setProperty("--primary","#1a221b"),e.style.setProperty("--nav","#171f18"),e.style.setProperty("--text-primary","#b8d2b9"),e.style.setProperty("--text-secondary","#a6c0a7"),e.style.setProperty("--icons-color","brightness(100%)")):"dark-paper"===t?(e.style.setProperty("--body-background","#1c1b1a"),e.style.setProperty("--primary","#242322"),e.style.setProperty("--nav","#222120"),e.style.setProperty("--text-primary","#d4d3d2"),e.style.setProperty("--text-secondary","#c2c1c0"),e.style.setProperty("--icons-color","brightness(100%)")):"dark-lavender"===t&&(e.style.setProperty("--body-background","#1c1920"),e.style.setProperty("--primary","#24202a"),e.style.setProperty("--nav","#221e26"),e.style.setProperty("--text-primary","#d2c9e0"),e.style.setProperty("--text-secondary","#c0b7d0"),e.style.setProperty("--icons-color","brightness(100%)")),document.body.className=t,e.style.setProperty("--default-font",s),document.body.style.fontSize=r,document.body.style.fontWeight=o;let m={theme:document.getElementById("set-theme").value,font:document.getElementById("set-font").value,fontSize:document.getElementById("set-font-size").value,fontWeight:document.getElementById("set-font-weight").value,lineHeight:document.getElementById("set-line-height").value,richTextToggle:document.getElementById("set-rich-text-toggle").checked,systemMsgStyle:document.getElementById("set-rich-system-msg").value,systemWindowStyle:document.getElementById("set-rich-system-window").value,constSpeechStyle:document.getElementById("set-rich-const").value,outerSpeechStyle:document.getElementById("set-rich-outer").value,quoteStyle:document.getElementById("set-rich-quote").value,noticeStyle:document.getElementById("set-rich-notice").value,genericBoxStyle:document.getElementById("set-rich-box").value};try{localStorage.setItem("settings",JSON.stringify(m)),console.log("Settings saved to local storage.")}catch(g){console.error("Error saving settings to local storage:",g)}y?(document.getElementById("set-rich-system-msg").disabled=!1,document.getElementById("set-rich-system-window").disabled=!1,document.getElementById("set-rich-const").disabled=!1,document.getElementById("set-rich-outer").disabled=!1,document.getElementById("set-rich-quote").disabled=!1,document.getElementById("set-rich-notice").disabled=!1,document.getElementById("set-rich-box").disabled=!1):(document.getElementById("set-rich-system-msg").disabled=!0,document.getElementById("set-rich-system-window").disabled=!0,document.getElementById("set-rich-const").disabled=!0,document.getElementById("set-rich-outer").disabled=!0,document.getElementById("set-rich-quote").disabled=!0,document.getElementById("set-rich-notice").disabled=!0,document.getElementById("set-rich-box").disabled=!0,y="theme1",n="theme1",a="theme1",i="theme1",c="theme1",d="theme1",h="theme1",p="theme1",console.log("Rich text features disabled")),classChangeTheme("orv_system",n),classChangeTheme("orv_window",a),classChangeTheme("orv_constellation",i),classChangeTheme("orv_outergod",c),classChangeTheme("orv_quote",d),classChangeTheme("orv_notice",h),classChangeTheme("orv_box",p)}t(),window.applySettings=t,e.addEventListener("change",function(e){t()}),document.getElementById("set-font-size").addEventListener("input",function(e){t()}),document.getElementById("set-font-weight").addEventListener("input",function(e){t()}),document.getElementById("set-line-height").addEventListener("input",function(e){t()}),e.addEventListener("reset",function(e){setTimeout(t,0)})});let chFetchStatus=!1;const ChapterList=[];function addAllChapters(){let e=document.getElementById("main-script"),t=e.dataset.titles;chFetchStatus||fetch(t).then(e=>{if(!e.ok)throw Error("Network response was not ok "+e.statusText);return e.json()}).then(e=>{ChapterList.push(...e),console.log("Chapters loaded:",ChapterList),chFetchStatus=!0}).catch(e=>{console.error("There was a problem with the fetch operation:",e)}).then(()=>{let e=document.getElementById("chapter-search-reasult"),t=document.getElementsByClassName("orv_title")[0].textContent.trim(),s="",r=[];ChapterList.forEach(e=>{t===e.title&&(s="current-chapter",e.index=""),r.push(`<div class="chapter_item" id="${s}"><a href="./ch_${e.index+1}"><p>${e.title}</p></a></div>`),s=""}),e.innerHTML=r.join(""),document.getElementById("current-chapter").scrollIntoView({behavior:"smooth",block:"center"})})}function openChapters(){addAllChapters(),document.getElementById("chapters").style.display="block"}function findChapter(){let e=document.getElementById("find-chapter").value.trim(),t=document.getElementById("chapter-search-reasult");t.innerHTML="";let s=[];for(let r=0;r<ChapterList.length;r++){let o=String(ChapterList[r].title).toLowerCase(),l=o.indexOf(e.toLowerCase()),y=ChapterList[r].index;-1!==l&&s.push(`<div class="chapter_item"><a href="./ch_${y+1}"><p>${o}</p></a></div>`)}t.innerHTML=s.join(""),0===s.length&&(t.innerHTML='<div class="chapter_item"><p>Chapter not found</p></div>')}
