let ChapterList=[];const script=document.getElementById("main-script");function addAllChapters(){fetch(script.dataset.title).then(t=>{if(!t.ok)throw Error("Network response was not ok "+t.statusText);return t.json()}).then(t=>{ChapterList.push(...t),ChapterList=ChapterList.slice().sort((t,e)=>e.index-t.index),console.log("Chapters loaded:",ChapterList),displayChapters()}).catch(t=>{console.error("There was a problem with the fetch operation:",t)})}function addMeta(){fetch(script.dataset.meta).then(t=>{if(!t.ok)throw Error("Network response was not ok "+t.statusText);return t.json()}).then(t=>{let e=document.getElementsByClassName("status")[0];console.log(t),e.innerHTML=`
            <p>${t.title}</p>
            <p>Author: ${t.author}<br>
                Chapters: ${t.chapters}<br>
                Status: ${t.status}</p>`}).catch(t=>{console.error("There was a problem with the fetch operation:",t)})}function displayChapters(){let t=document.getElementById("chapter-result");t.innerHTML="";let e=[];ChapterList.forEach(t=>{e.push(`<div class="chapter_item"><a href="./read/ch_${t.index+1}"><p>${t.title}</p></a></div>`)}),t.innerHTML=e.join("")}function filter(){ChapterList=ChapterList.slice().reverse(),document.getElementById("search").value="",console.log(document.getElementById("filter").style.transform);let t=document.getElementById("filter");"rotateX(180deg)"===t.style.transform?t.style.transform="rotateX(0deg)":t.style.transform="rotateX(180deg)",displayChapters()}function findChapter(t){let e=document.getElementById("chapter-result");e.innerHTML="";let r=[];for(let a=0;a<ChapterList.length;a++){let s=String(ChapterList[a].title).toLowerCase(),n=s.indexOf(t.toLowerCase()),i=ChapterList[a].index;-1!==n&&r.push(`<div class="chapter_item"><a href="./read/ch_${i+1}"><p>${s}</p></a></div>`)}e.innerHTML=r.join(""),0===r.length&&(e.innerHTML='<div class="chapter_item"><p>Chapter not found</p></div>')}document.addEventListener("DOMContentLoaded",function(){let t=parseInt(localStorage.getItem("lastread")),e=localStorage.getItem("lasttype");if(console.log(t,e),t&&e===script.dataset.type){let r=document.getElementById("read"),a=document.getElementById("read-a");a.href=`./read/ch_${t+1}`,r.textContent="Continue"}}),addMeta(),document.addEventListener("DOMContentLoaded",function(){addAllChapters()});
